<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åœ‹æ–‡ä¹å¼ãƒ»é™é­”ä¿®ç…‰è·¯</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700;900&family=Zen+Maru+Gothic:wght@500;700&display=swap');
        
        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: #1a1a1a;
            color: #e5e5e5;
            overscroll-behavior: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        .serif { font-family: 'Noto Serif TC', serif; }
        .text-shadow { text-shadow: 2px 2px 0px rgba(0,0,0,0.5); }

        /* èƒŒæ™¯ç´‹ç† */
        .scroll-bg {
            background-image: radial-gradient(#333 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* é‡é»é«˜äº®æ¨£å¼ */
        .highlight-text {
            background-color: rgba(251, 191, 36, 0.3);
            color: #fbbf24;
            padding: 0 4px;
            border-radius: 4px;
            font-weight: bold;
            border-bottom: 2px solid #fbbf24;
        }

        /* åˆªé™¤ç·šæ¨£å¼ */
        .dim-text {
            opacity: 0.3;
            text-decoration: line-through;
        }

        /* æ–·å¥åˆ€ç—• */
        .cut-mark {
            display: inline-block;
            width: 3px;
            height: 1.2em;
            background-color: #ef4444;
            margin: 0 4px;
            vertical-align: middle;
            box-shadow: 0 0 5px red;
        }

        /* æŒ‰éˆ•å‹•ç•« */
        .btn-press:active { transform: scale(0.95); }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="scroll-bg h-screen w-screen overflow-hidden flex flex-col">
    <div id="root" class="h-full w-full max-w-md mx-auto flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- éŠæˆ²è³‡æ–™åº« ---
        const LEVELS = [
            {
                id: 1,
                name: "ç¬¬ä¸€é—œï¼šè¿·éœ§æ£®æ—",
                skill: "æ…§çœ¼",
                icon: "ğŸ‘ï¸",
                desc: "å¿…å‹ç¬¬ä¸€å¼ï¼šç¯‡åå‘¼æ‡‰ã€‚å…ˆçœ‹ç¯‡åï¼Œé æ¸¬ä¸»æ—¨ï¼",
                color: "text-emerald-400",
                enemies: [
                    {
                        name: "èŒ¶é¦™éœ§å¦–",
                        type: "å°æ€ª",
                        hp: 1,
                        source: "109å¹´æœƒè€ƒ",
                        title: "ã€ˆå–èŒ¶åŠ ä¸åŠ ç³–ï¼ŒåŸä¾†å’Œéšç´šæœ‰é—œã€‰",
                        content: "å–èŒ¶åŠ æª¸æª¬æ˜¯ç¾å¼ä½œæ³•...å‹å‹•éšç´šçš„é£²èŒ¶æ–¹å¼ï¼Œå‰‡æ˜¯ä»¥èŒ¶åŒ…æ²–æ³¡æ–¼é¦¬å…‹æ¯ä¸­å½¢æˆæ¿ƒèŒ¶å¾Œå†åŠ å…¥ç³–...",
                        skillEffect: "highlight",
                        skillTarget: ["å‹å‹•éšç´š", "æ¿ƒèŒ¶", "åŠ å…¥ç³–"],
                        preQuestion: "é€™ç¯‡æ–‡ç« çš„ä¸»æ—¨åœ¨è¬›ä»€éº¼ï¼Ÿ",
                        preOptions: ["èŒ¶è‘‰ç¨®æ¤", "éšç´šèˆ‡å–èŒ¶ç¿’æ…£"],
                        preAnswer: 1,
                        finalQuestion: "æ ¹æ“šæœ¬æ–‡ï¼Œæ˜”æ—¥è‹±åœ‹å‹å‹•éšç´šçš„å–èŒ¶æ–¹å¼ç‚ºä½•ï¼Ÿ",
                        options: ["ç“·å™¨ã€æ·¡èŒ¶ã€ä¸åŠ ç³–", "é¦¬å…‹æ¯ã€æ¿ƒèŒ¶ã€åŠ ç³–", "ç“·å™¨ã€æ¿ƒèŒ¶ã€åŠ ç³–", "é¦¬å…‹æ¯ã€æ·¡èŒ¶ã€ä¸åŠ ç³–"],
                        answer: 1
                    },
                    {
                        name: "å›æ†¶æ¨¹ç²¾",
                        type: "èè‹±",
                        hp: 2,
                        source: "105å¹´æœƒè€ƒ",
                        title: "å‘é™½ã€ˆå°æ²³ã€‰",
                        content: "å°æ²³å‘¢ï¼Ÿé‚£å¿µå¿µä¸å¿˜çš„å°æ²³...ä¹¾ç™Ÿã€ç˜¦å‰Šï¼Œè€Œä¸”çœ‹ä¾†ç—›è‹¦...å †ç©è‘—ç ´éŠ…çˆ›éµï¼Œç´™å¼µåƒåœ¾...",
                        skillEffect: "highlight",
                        skillTarget: ["ä¹¾ç™Ÿã€ç˜¦å‰Š", "ç—›è‹¦", "å †ç©è‘—ç ´éŠ…çˆ›éµ"],
                        preQuestion: "é€™é¦–è©©çš„ä¸»è§’æ˜¯ï¼Ÿ",
                        preOptions: ["æŸå€‹äºº", "ä¸€æ¢æ²³"],
                        preAnswer: 1,
                        finalQuestion: "æ–‡ä¸­ç•«ç·šè™•ã€ä¹¾ç™Ÿã€ç˜¦å‰Šã€éš±å«ä»€éº¼å¿ƒæƒ…ï¼Ÿ",
                        options: ["é©šæ„•èˆ‡å¤±è½", "æ†¤æ€’èˆ‡ä»‡æ¨", "å¹³éœèˆ‡æ¥ç´", "èˆˆå¥®èˆ‡æœŸå¾…"],
                        answer: 0
                    },
                    {
                        name: "ç¦®æ•™çŸ³åƒ",
                        type: "BOSS",
                        hp: 3,
                        source: "110å¹´æœƒè€ƒ",
                        title: "å¸é¦¬å…‰ã€ˆç­”è–›è™Ÿå·è¬çŸ³æœˆå±æ›¸ã€‰",
                        content: "æ—¥å‰ä»¤éƒè¨ªé€®ï¼Œå‡ºæ‰‹ç­†ä¸¦çŸ³æœˆå±ç‚ºè´ˆ...æ¯”ä¾†ï¼Œæ•¸æ–¼éƒ½ä¸‹æœ‹å¾è™•è¦‹æ­¤å±...",
                        skillEffect: "highlight",
                        skillTarget: ["ç­”", "è¬", "ä»¤éƒ"],
                        preQuestion: "é€™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯ï¼Ÿ",
                        preOptions: ["è¨å‚µ", "ç­”è¬ç¦®ç‰©"],
                        preAnswer: 1,
                        finalQuestion: "æ–‡ä¸­ã€ä»¤éƒã€æ˜¯æŒ‡èª°ï¼Ÿ",
                        options: ["è–›è™Ÿå·çš„å…’å­", "å¸é¦¬å…‰çš„å…’å­", "çŸ³æœˆå±çš„ä½œè€…", "é€ç¦®çš„åƒ•äºº"],
                        answer: 0
                    }
                ]
            },
            {
                id: 2,
                name: "ç¬¬äºŒé—œï¼šæ–·å¥å³½è°·",
                skill: "æ–·å¥åˆ€",
                icon: "âš”ï¸",
                desc: "å¿…å‹ç¬¬äºŒå¼ï¼šæ¨™é»æ–·å¥ã€‚æ‰¾å‡ºèªæ°£è½‰æŠ˜èˆ‡çµæŸé»ï¼",
                color: "text-red-400",
                enemies: [
                    {
                        name: "æ¨™é»å²èŠå§†",
                        type: "å°æ€ª",
                        hp: 1,
                        source: "111å¹´æœƒè€ƒ",
                        title: "è¨˜æ†¶èˆ‡æ•˜è¿°",
                        content: "æ•˜è¿°è¨˜æ†¶æ˜¯ä»¶é›£äº‹...å°±ç®—æ‹¼æ¹Šèµ·ä¾†äº†ä¹™ä¹Ÿåªç®—æ˜¯æ­»çš„æ¨™æœ¬...è¦æƒ³å°‡é¢¨ç‰‡åˆ‡ä¸‹ä¾†ï¼Œè±ˆä¸å®Œå…¨æ˜¯ä¸€å ´å¾’å‹å—ä¸",
                        skillEffect: "cut",
                        skillTarget: "ä¸",
                        preQuestion: "é€™æ®µè©±æœ€å¾Œæ˜¯ç”¨ä»€éº¼èªæ°£çµæŸï¼Ÿ",
                        preOptions: ["è‚¯å®šå¥", "åå•å¥"],
                        preAnswer: 1,
                        finalQuestion: "æ–‡ä¸­ç”²ä¹™ä¸™ä¸ä½•è™•æœ€é©åˆå¡«å…¥ã€å¥è™Ÿã€ï¼Ÿ",
                        options: ["ç”²", "ä¹™", "ä¸™", "ä¸"],
                        answer: 3
                    },
                    {
                        name: "æ†¤æ€’ç‹‚ç‰›",
                        type: "èè‹±",
                        hp: 2,
                        source: "107å¹´æœƒè€ƒ",
                        title: "æ†¤æ€’èˆ‡é…¸è…",
                        content: "æˆ‘å¯§é¡˜å»å“å˜—è¾›è¾£çš„æ†¤æ€’...å¯ä»¥ç—›å®šæ€ç—›ï¼Œæœ‰çŒ›çœçš„ä½œç”¨å”¯ç¨é…¸è…ï¼Œåªæœ‰é¤¿è‡­æ•—å£ä¸€é€”...",
                        skillEffect: "cut",
                        skillTarget: "å”¯ç¨",
                        preQuestion: "ã€å”¯ç¨ã€å‰é¢æ‡‰è©²ç”¨ä»€éº¼ç¬¦è™Ÿéš”é–‹æ’æ¯”å¥ï¼Ÿ",
                        preOptions: ["é€—è™Ÿ (,)", "åˆ†è™Ÿ (;)"],
                        preAnswer: 1,
                        finalQuestion: "æ–‡ä¸­ç¼ºç©ºè™•æ‡‰å¡«å…¥ä»€éº¼æ¨™é»ç¬¦è™Ÿï¼Ÿ",
                        options: ["ï¼Œ", "ï¼›", "ï¼", "ï¼š"],
                        answer: 1
                    },
                    {
                        name: "é›™é ­çµäºº",
                        type: "BOSS",
                        hp: 3,
                        source: "106å¹´æœƒè€ƒ",
                        title: "çµäººèˆ‡è¾²å¤«",
                        content: "ç¾åœ¨æ‰€è¬‚æ³¨æ„åŠ›ç¼ºå¤±è€…çš„ç‰¹å¾µâ€”â€”å®¹æ˜“åˆ†å¿ƒã€è¡å‹•ã€å†’éšªæ€§å¼·ï¼Œå…¶å¯¦æ˜¯é å¤æ‰“çµæ¡é›†æ™‚ç”Ÿå­˜å¿…è¦çš„ç‰¹å¾µã€‚",
                        skillEffect: "highlight",
                        skillTarget: ["â€”â€”", "ç‰¹å¾µ"],
                        preQuestion: "ç ´æŠ˜è™Ÿåœ¨æ­¤è™•çš„åŠŸèƒ½æ˜¯ï¼Ÿ",
                        preOptions: ["è²éŸ³å»¶é•·", "è§£é‡‹èªªæ˜"],
                        preAnswer: 1,
                        finalQuestion: "ä½œè€…å°ADHDè€…çš„çœ‹æ³•ç‚ºä½•ï¼Ÿ",
                        options: ["æ‡‰æ¥å—æ²»ç™‚", "ä¸å®œä»¥ç•°é¡çœ¼å…‰çœ‹å¾…", "åŸºå› æ¯”å¸¸äººå„ªç§€", "æ˜¯ç¤¾æœƒçš„è² æ“”"],
                        answer: 1
                    }
                ]
            },
            {
                id: 3,
                name: "ç¬¬ä¸‰é—œï¼šé‚è¼¯è¿·å®®",
                skill: "è½‰æŠ˜ç›¾",
                icon: "ğŸ›¡ï¸",
                desc: "å¿…å‹ç¬¬ä¸‰å¼ï¼šé‚è¼¯å­—è©ã€‚æ“‹æ‰å»¢è©±ï¼Œç•™ä¸‹é‡é»ï¼",
                color: "text-blue-400",
                enemies: [
                    {
                        name: "æ²¸æ°´æ€ª",
                        type: "å°æ€ª",
                        hp: 1,
                        source: "105å¹´æœƒè€ƒ",
                        title: "æšæ¹¯æ­¢æ²¸",
                        content: "å¤«æŠ•è† ä»¥è®Šæ¿ï¼Œä¸å¦‚æ¾„å…¶æº...æšæ¹¯ä»¥æ­¢æ²¸ï¼Œä¸å¦‚çµ•å…¶è–ªè€Œæ²¸æ­¢ä¹‹é€Ÿä¹Ÿã€‚",
                        skillEffect: "dim",
                        skillTarget: ["æšæ¹¯ä»¥æ­¢æ²¸"],
                        preQuestion: "ã€ä¸å¦‚ã€è¡¨ç¤ºé‡é»åœ¨å¾Œå¥ï¼Œå¾Œå¥å¼·èª¿ä»€éº¼ï¼Ÿ",
                        preOptions: ["æ²»æ¨™", "æ²»æœ¬"],
                        preAnswer: 1,
                        finalQuestion: "ä¸‹åˆ—ä½•è€…æœ€ç¬¦åˆä½œè€…è§€é»ï¼Ÿ",
                        options: ["æšæ¹¯æ­¢æ²¸", "æŠ•è† è®Šæ¿", "çµ•è–ªæ­¢æ²¸", "å¤šæ–¹æ•‘å¤±"],
                        answer: 2
                    },
                    {
                        name: "é›»å½±å¹»è¡“å¸«",
                        type: "èè‹±",
                        hp: 2,
                        source: "107å¹´æœƒè€ƒ",
                        title: "é›»å½±è—åœ–",
                        content: "åŠªåŠ›ç ”ç™¼èºçµ²é‡˜ï¼Œé›–ç„¶é€™ä¹Ÿå¾ˆé‡è¦ï¼Œä½†å…ˆæœ‰è—åœ–ï¼Œç­‰æ•´å€‹å¸‚å ´æœ‰èµ·è‰²å¾Œï¼Œå†å»æ‰¶æ¤ï¼ŒåŠ›é‡æ‰æœƒæ›´å¤§ã€‚",
                        skillEffect: "dim",
                        skillTarget: ["åŠªåŠ›ç ”ç™¼èºçµ²é‡˜", "é›–ç„¶é€™ä¹Ÿå¾ˆé‡è¦"],
                        preQuestion: "ã€ä½†ã€å­—å‡ºç¾ï¼Œé‡é»åœ¨å“ªè£¡ï¼Ÿ",
                        preOptions: ["å‰é¢çš„èºçµ²é‡˜", "å¾Œé¢çš„è—åœ–"],
                        preAnswer: 1,
                        finalQuestion: "é€™æ®µæ–‡å­—å¼·èª¿é›»å½±ç”¢æ¥­ç™¼å±•çš„æ ¹æœ¬æ˜¯ä»€éº¼ï¼Ÿ",
                        options: ["å¥½çš„åŠ‡æœ¬å’Œè£½ä½œæ¡ˆ(è—åœ–)", "å¥½çš„ç‰¹æ•ˆ(èºçµ²é‡˜)", "é¾å¤§çš„è³‡é‡‘", "çŸ¥åæ¼”å“¡"],
                        answer: 0
                    },
                    {
                        name: "æ·±å½é­”ç‹",
                        type: "BOSS",
                        hp: 3,
                        source: "113å¹´æœƒè€ƒ",
                        title: "æ·±å½æŠ€è¡“",
                        content: "è‹¥å°‡å®ƒé‹ç”¨æ–¼å½±è¦–ä½œå“...æœ‰æ­£é¢çš„æ•ˆç›Šã€‚ä½†ä¹Ÿæœ‰äººåˆ©ç”¨åˆæˆçš„å‡å½±åƒæ“å¼„è³‡è¨Šï¼Œé€²è€Œè©é¨™ç‰Ÿåˆ©...",
                        skillEffect: "dim",
                        skillTarget: ["æœ‰æ­£é¢çš„æ•ˆç›Š"],
                        preQuestion: "ä½œè€…æƒ³å¼·èª¿æ·±å½æŠ€è¡“çš„å“ªä¸€é¢ï¼Ÿ",
                        preOptions: ["æ­£é¢æ•ˆç›Š", "è² é¢çˆ­è­°"],
                        preAnswer: 1,
                        finalQuestion: "æ ¹æ“šæœ¬æ–‡ï¼Œæ·±å½æŠ€è¡“æœ€å¤§çš„éš±æ†‚æ˜¯ä»€éº¼ï¼Ÿ",
                        options: ["æˆæœ¬éé«˜", "å–ä»£æ¼”å“¡å·¥ä½œ", "é€ æˆæ°‘çœ¾å°ç¤¾æœƒçš„ä¸ä¿¡ä»»", "æŠ€è¡“é–€æª»å¤ªä½"],
                        answer: 2
                    }
                ]
            },
            {
                id: 4,
                name: "ç¬¬å››é—œï¼šæ•¸æ“šé«˜å¡”",
                skill: "é·¹çœ¼",
                icon: "ğŸ¦…",
                desc: "å¿…å‹ç¬¬å››å¼ï¼šåœ–è¡¨åˆ¤è®€ã€‚å®šé¡å‹ã€æ‰¾æ¥µå€¼ï¼",
                color: "text-purple-400",
                enemies: [
                    {
                        name: "èƒŒåŒ…æ–¹å¡Š",
                        type: "å°æ€ª",
                        hp: 1,
                        source: "105å¹´æœƒè€ƒ",
                        title: "èƒŒåŒ…èˆ‡å¥åº·",
                        content: "åœ–è¡¨é¡¯ç¤ºï¼šé«”é‡60å…¬æ–¤è€…ï¼Œå»ºè­°èƒŒåŒ…é‡é‡6kgä»¥ä¸‹ï¼ŒèƒŒå¸¶è¦çŸ­ä¸”è²¼èƒŒã€‚",
                        skillEffect: "highlight",
                        skillTarget: ["60å…¬æ–¤", "èƒŒå¸¶çŸ­", "è²¼èƒŒ"],
                        preQuestion: "é«”é‡60å…¬æ–¤çš„äººï¼ŒèƒŒåŒ…æ‡‰è©²æ€éº¼èƒŒï¼Ÿ",
                        preOptions: ["èƒŒå¸¶é•·ï¼Œé›¢èº«é«”é ", "èƒŒå¸¶çŸ­ï¼Œè²¼è¿‘èº«é«”"],
                        preAnswer: 1,
                        finalQuestion: "å“ªä¸€å€‹åœ–ç¤ºç¬¦åˆå¥åº·èƒŒæ³•ï¼Ÿ",
                        options: ["èƒŒå¸¶å¾ˆé•·å‚åˆ°å±è‚¡", "èƒŒå¸¶çŸ­ï¼ŒèƒŒåŒ…è²¼èƒŒ", "å´èƒŒä¸”å¾ˆé‡", "æ‰‹æ"],
                        answer: 1
                    },
                    {
                        name: "äººå£é•·æ¢æ€ª",
                        type: "èè‹±",
                        hp: 2,
                        source: "110å¹´æœƒè€ƒ",
                        title: "æ–°ä½æ°‘å­å¥³çµ±è¨ˆ",
                        content: "é•·æ¢åœ–é¡¯ç¤ºï¼šéæ–°ä½æ°‘å­å¥³(ç¶²é»é•·æ¢)é€å¹´ä¸‹é™ã€‚åœ‹å°æ–°ä½æ°‘å­å¥³(æ·ºè‰²é•·æ¢)æŒå¹³æˆ–å¾®é™ã€‚",
                        skillEffect: "highlight",
                        skillTarget: ["é€å¹´ä¸‹é™", "æŒå¹³"],
                        preQuestion: "æˆ‘å€‘è¦æ‰¾ã€éŒ¯èª¤ã€çš„æ•˜è¿°ï¼Œé¦–å…ˆè§€å¯Ÿç¶²é»é•·æ¢çš„è¶¨å‹¢æ˜¯ï¼Ÿ",
                        preOptions: ["ä¸Šå‡", "ä¸‹é™"],
                        preAnswer: 1,
                        finalQuestion: "æ ¹æ“šåœ–è¡¨ï¼Œä¸‹åˆ—æ•˜è¿°ä½•è€…éŒ¯èª¤ï¼Ÿ",
                        options: ["åœ‹ä¸­å°å­¸ç”Ÿç¸½äººæ•¸ä¸‹é™", "åœ‹å°æ–°ä½æ°‘å­å¥³äººæ•¸å¤§å¹…ä¸Šå‡", "åœ‹ä¸­æ–°ä½æ°‘å­å¥³æ¯”ä¾‹ä¸Šå‡", "éæ–°ä½æ°‘å­å¥³æ¯”ä¾‹ä¸‹é™"],
                        answer: 1
                    },
                    {
                        name: "ç¶“è²»å·¨åƒ",
                        type: "BOSS",
                        hp: 3,
                        source: "107å¹´æœƒè€ƒ",
                        title: "å„åœ‹æ•™è‚²ç¶“è²»",
                        content: "é•·æ¢åœ–é¡¯ç¤ºï¼šä¸åœ‹çš„é«˜ä¸­ç”Ÿ(æ·±è‰²é•·æ¢)ç¶“è²»æŸ±å­æ˜¯æ‰€æœ‰åœ‹å®¶ä¸­æœ€é«˜çš„ã€‚",
                        skillEffect: "highlight",
                        skillTarget: ["ä¸åœ‹", "é«˜ä¸­", "æœ€é«˜"],
                        preQuestion: "æ¯”è¼ƒå„åœ‹æŸ±å­é«˜åº¦ï¼Œå“ªä¸€åœ‹çš„é«˜ä¸­ç¶“è²»æœ€é«˜ï¼Ÿ",
                        preOptions: ["ç”²åœ‹", "ä¸åœ‹"],
                        preAnswer: 1,
                        finalQuestion: "æ ¹æ“šåœ–è¡¨ï¼Œä¸‹åˆ—æ•˜è¿°ä½•è€…æ­£ç¢ºï¼Ÿ",
                        options: ["ç”²åœ‹å°å­¸ç”Ÿç¶“è²»æœ€é«˜", "ä¸™åœ‹åœ‹ä¸­ç”Ÿç¶“è²»æœ€é«˜", "å„åœ‹é«˜ç­‰æ•™è‚²ç¶“è²»éƒ½æœ€å¤š", "ä¸åœ‹é«˜ä¸­ç”Ÿç¶“è²»æœ€é«˜"],
                        answer: 3
                    }
                ]
            }
        ];

        // --- éŠæˆ²çµ„ä»¶ ---

        const MainMenu = ({ onStart }) => (
            <div className="flex flex-col items-center justify-center h-full p-6 text-center space-y-8 fade-in">
                <div className="bg-black/30 p-8 rounded-2xl border border-gray-600 backdrop-blur-sm">
                    <div className="text-yellow-500 text-xl mb-2 font-bold tracking-widest">åœ‹æ–‡æœƒè€ƒç‰¹è¨“</div>
                    <h1 className="text-5xl font-black text-white text-shadow serif mb-4">åœ‹æ–‡ä¹å¼</h1>
                    <h2 className="text-3xl font-bold text-red-500 text-shadow serif mb-8">é™é­”ä¿®ç…‰è·¯</h2>
                    
                    <button 
                        onClick={onStart}
                        className="btn-press bg-red-600 hover:bg-red-500 text-white px-10 py-4 rounded-full text-xl font-bold shadow-lg border-2 border-red-400 w-full"
                    >
                        âš¡ é–‹å§‹ä¿®ç…‰
                    </button>
                </div>
            </div>
        );

        const BattleScene = ({ levelData, roundData, onWin, onLose }) => {
            const [phase, setPhase] = useState("intro"); // intro, pre-skill, skill-check, final
            const [processedContent, setProcessedContent] = useState(roundData.content);
            const [feedback, setFeedback] = useState("");

            useEffect(() => {
                setPhase("intro");
                setProcessedContent(roundData.content);
                setFeedback("");
            }, [roundData]);

            const handlePreAnswer = (index) => {
                if (index === roundData.preAnswer) {
                    if (roundData.skillEffect === "highlight") {
                        let newContent = roundData.content;
                        roundData.skillTarget.forEach(target => {
                            newContent = newContent.replace(new RegExp(target, 'g'), `<span class="highlight-text">${target}</span>`);
                        });
                        setProcessedContent(newContent);
                    } else if (roundData.skillEffect === "cut") {
                        const parts = roundData.content.split(roundData.skillTarget);
                        setProcessedContent(`${parts[0]}<span class="cut-mark"></span>${roundData.skillTarget}${parts[1] || ''}`);
                    } else if (roundData.skillEffect === "dim") {
                        let newContent = roundData.content;
                        roundData.skillTarget.forEach(target => {
                            newContent = newContent.replace(new RegExp(target, 'g'), `<span class="dim-text">${target}</span>`);
                        });
                        setProcessedContent(newContent);
                    }
                    
                    setFeedback("âœ… æŠ€èƒ½ç™¼å‹•æˆåŠŸï¼ç ´ç¶»å·²ç¾ï¼");
                    setTimeout(() => {
                        setPhase("final");
                        setFeedback("");
                    }, 1000);
                } else {
                    setFeedback("âŒ é åˆ¤éŒ¯èª¤ï¼å—åˆ°åæ“Šï¼");
                    setTimeout(() => onLose(), 800);
                }
            };

            const handleFinalAnswer = (index) => {
                if (index === roundData.answer) {
                    setFeedback("âš”ï¸ æœƒå¿ƒä¸€æ“Šï¼");
                    setTimeout(onWin, 1000);
                } else {
                    setFeedback("ğŸ›¡ï¸ æ”»æ“Šè¢«æ ¼æ“‹äº†ï¼");
                    setTimeout(onLose, 800);
                }
            };

            return (
                <div className="h-full flex flex-col p-4 fade-in">
                    {/* é ‚éƒ¨è³‡è¨Š */}
                    <div className="flex justify-between items-center mb-4 bg-gray-800/80 p-3 rounded-lg border border-gray-600">
                        <div>
                            <div className="text-xs text-gray-400">{levelData.name}</div>
                            <div className="font-bold text-yellow-500 text-lg">{roundData.name} <span className="text-sm text-gray-300">({roundData.type})</span></div>
                        </div>
                        <div className="text-xs bg-gray-700 px-2 py-1 rounded border border-gray-500">{roundData.source}</div>
                    </div>

                    {/* æ€ªç‰©èˆ‡æ–‡æœ¬å€ */}
                    <div className="flex-1 flex flex-col items-center justify-start overflow-y-auto">
                        <div className={`w-24 h-24 rounded-full flex items-center justify-center text-5xl bg-gray-800 border-4 border-gray-600 mb-4 shadow-lg ${phase !== 'intro' ? 'scale-110 border-red-500 transition-all' : ''}`}>
                            {levelData.id === 1 ? "ğŸŒ«ï¸" : levelData.id === 2 ? "ğŸ" : levelData.id === 3 ? "ğŸ‚" : "ğŸ¯"}
                        </div>
                        
                        <div className="w-full bg-gray-800/90 p-4 rounded-lg border border-gray-500 shadow-md mb-4">
                            <div className="text-yellow-400 text-sm font-bold mb-2 border-b border-gray-600 pb-1">
                                {levelData.id === 1 ? "ã€ç¯‡åã€‘" : "ã€åŸæ–‡/åœ–è¡¨ã€‘"} {roundData.title}
                            </div>
                            <div 
                                className="text-lg leading-loose text-gray-200"
                                dangerouslySetInnerHTML={{ __html: processedContent }} 
                            />
                        </div>
                    </div>

                    {/* äº’å‹•å€ */}
                    <div className="mt-auto">
                        {feedback && (
                            <div className="mb-4 bg-black/80 text-white p-3 rounded text-center font-bold text-xl border border-yellow-500 animate-bounce">
                                {feedback}
                            </div>
                        )}

                        {phase === "intro" && (
                            <div className="bg-gray-900/90 p-4 rounded-xl border-t-4 border-blue-500 shadow-lg">
                                <p className="mb-4 text-gray-300 text-center">{levelData.desc}</p>
                                <button 
                                    onClick={() => setPhase("pre-skill")}
                                    className="btn-press w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg text-lg"
                                >
                                    ğŸ“– è§€å¯Ÿæ•µæƒ…
                                </button>
                            </div>
                        )}

                        {phase === "pre-skill" && (
                            <div className="bg-gray-900/90 p-4 rounded-xl border-t-4 border-yellow-500 shadow-lg">
                                <div className="flex items-center gap-2 mb-3 text-yellow-400 font-bold">
                                    <span>{levelData.icon}</span> ç™¼å‹•æŠ€èƒ½ï¼š{levelData.skill}
                                </div>
                                <p className="mb-3 font-bold text-white">{roundData.preQuestion}</p>
                                <div className="grid gap-2">
                                    {roundData.preOptions.map((opt, idx) => (
                                        <button
                                            key={idx}
                                            onClick={() => handlePreAnswer(idx)}
                                            className="btn-press bg-gray-700 hover:bg-gray-600 p-3 rounded text-left border border-gray-600 font-bold text-white"
                                        >
                                            {opt}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {phase === "final" && (
                            <div className="bg-gray-900/90 p-4 rounded-xl border-t-4 border-red-500 shadow-lg">
                                <div className="flex items-center gap-2 mb-3 text-red-400 font-bold">
                                    <span>âš”ï¸</span> çµ‚çµä¸€æ“Š
                                </div>
                                <p className="mb-3 font-bold text-white">{roundData.finalQuestion}</p>
                                <div className="grid gap-2">
                                    {roundData.options.map((opt, idx) => (
                                        <button
                                            key={idx}
                                            onClick={() => handleFinalAnswer(idx)}
                                            className="btn-press bg-gray-700 hover:bg-gray-600 p-3 rounded text-left border border-gray-600 text-white"
                                        >
                                            <span className="text-yellow-500 font-bold mr-2">{String.fromCharCode(65 + idx)}.</span>
                                            {opt}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const App = () => {
            const [gameState, setGameState] = useState("menu");
            const [currentLevelIdx, setCurrentLevelIdx] = useState(0);
            const [currentRoundIdx, setCurrentRoundIdx] = useState(0);
            const [lives, setLives] = useState(3);

            const handleWinRound = () => {
                if (currentRoundIdx < LEVELS[currentLevelIdx].enemies.length - 1) {
                    setCurrentRoundIdx(prev => prev + 1);
                } else {
                    if (currentLevelIdx < LEVELS.length - 1) {
                        setCurrentLevelIdx(prev => prev + 1);
                        setCurrentRoundIdx(0);
                    } else {
                        setGameState("victory");
                    }
                }
            };

            const handleLoseRound = () => {
                if (lives > 1) {
                    setLives(prev => prev - 1);
                } else {
                    setGameState("gameover");
                }
            };

            const resetGame = () => {
                setGameState("menu");
                setCurrentLevelIdx(0);
                setCurrentRoundIdx(0);
                setLives(3);
            };

            if (gameState === "menu") return <MainMenu onStart={() => setGameState("playing")} />;

            if (gameState === "victory") return (
                <div className="h-full flex flex-col items-center justify-center p-6 text-center bg-gray-900 text-white">
                    <div className="text-8xl mb-6">ğŸ†</div>
                    <h1 className="text-4xl font-bold text-yellow-400 mb-4">ä¿®ç…‰å®Œæˆï¼</h1>
                    <p className="text-xl mb-8">æ­å–œå¤§ä¿ ï¼ä½ å·²æŒæ¡åœ‹æ–‡ä¹å¼ï¼Œ<br/>æœƒè€ƒé™é­”ç„¡å¾€ä¸åˆ©ï¼</p>
                    <button onClick={resetGame} className="bg-yellow-600 px-8 py-3 rounded-full font-bold text-xl">å†ä¾†ä¸€å±€</button>
                </div>
            );

            if (gameState === "gameover") return (
                <div className="h-full flex flex-col items-center justify-center p-6 text-center bg-gray-900 text-white">
                    <div className="text-8xl mb-6">ğŸ’€</div>
                    <h1 className="text-4xl font-bold text-red-500 mb-4">ä¿®ç…‰å¤±æ•—</h1>
                    <p className="text-xl mb-8">å‹æ•—ä¹ƒå…µå®¶å¸¸äº‹ï¼Œ<br/>å¤§ä¿ è«‹é‡æ–°ä¾†éã€‚</p>
                    <button onClick={resetGame} className="bg-gray-600 px-8 py-3 rounded-full font-bold text-xl">é‡æ–°æŒ‘æˆ°</button>
                </div>
            );

            const currentLevel = LEVELS[currentLevelIdx];
            const currentRound = currentLevel.enemies[currentRoundIdx];

            return (
                <div className="h-full flex flex-col max-w-md mx-auto bg-black/20">
                    <div className="p-3 flex justify-between items-center bg-black/60 z-10 border-b border-gray-700">
                        <div className="flex items-center gap-2">
                            <div className="bg-red-900 p-2 rounded-full border border-red-500 text-white font-bold text-xs">HP</div>
                            <div className="flex gap-1">
                                {[...Array(3)].map((_, i) => (
                                    <div key={i} className={`w-6 h-3 rounded-sm ${i < lives ? 'bg-green-500 shadow-[0_0_5px_lime]' : 'bg-gray-700'}`} />
                                ))}
                            </div>
                        </div>
                        <div className="font-bold text-sm text-gray-300">
                            é—œå¡ {currentLevelIdx + 1}-{currentRoundIdx + 1}
                        </div>
                    </div>

                    <BattleScene 
                        levelData={currentLevel}
                        roundData={currentRound}
                        onWin={handleWinRound}
                        onLose={handleLoseRound}
                    />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
